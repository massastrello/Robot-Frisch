a1 = 0.5;
a2 = 0.5;
g = 9.81;
kr1 = 0.1;
kr2 = 0.1;
W = [a1^2*qdd1+a1*g*cos(q1),...
    2*a1*qdd1+g*cos(q1),...
    qdd1,...
    kr1^2*qdd1,...
   (a1^2+2*a1*a2*cos(q2)+a2^2)*qdd1+...
       (a1*a2*cos(q2)+a2^2)*qdd2-...
       2*a1*a2*sin(q2)*qd1*qd2-...
       a1*a2*sin(q2)*qd2^2+...
       a1*g*cos(q1)+...
       a2*g*cos(q1+q2),...
       (2*a1*cos(q2)+2*a2)*qdd1+...
       (a1*cos(q2)+2*a2)*qdd2-...
       2*a1*sin(q2)*qd1*qd2-...
       a1*sin(q2)*qd2^2+...
       g*cos(q1+q2),...
       qdd1+qdd2,...
       kr2*qdd2;...
   0,0,0,0,...
       (a1*a2*cos(q2)+a2^2)*qdd1+...
       a2^2*qdd2+...
       a1*a2*sin(q2)*qd1^2+...
       a2*g*cos(q1+q2),...
       (a1*cos(q2)+2*a2)*qdd1+...
       2*a2*qdd2+...
       a1*sin(q2)*qd1^2+...
       g*cos(q1+q2),...
       qdd1+qdd2,...
       kr2*qdd1+kr2^2*qdd2];
 W = [[qd1,0,sign(qd1),0;...
       0,qd2,0,sign(qd2)],...
       W];
 